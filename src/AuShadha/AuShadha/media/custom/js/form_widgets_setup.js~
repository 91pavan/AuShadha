// alert( defaultTimePickerOptions. );
$(document).ready( function(){

var viewButtonHtml = "<button type='submit' name='btnView' style='cursor:pointer;' title='View' class='tableFormButton' action='viewButton'> <img src='/../../media/images/silk/icons/application_view_tile.png' alt='View'  ></button>";

var addButtonHtml = "<button type='submit' name='btnAdd' style='cursor:pointer;' title='Add' action='addButton' class='tableFormButton'> <img src='/../../media/images/silk/icons/add.png' alt='Add'  ></button>";

var saveButtonHtml = "<button type='submit' name='btnSave' style='cursor:pointer;' title='Save' action='saveButton' class='tableFormButton'> <img src='/../../media/images/silk/icons/disk.png' alt='Save'  ></button>";

var editButtonHtml = "<button type='submit'name='btnEdit' style='cursor:pointer;'  title='Edit' action='editButton' class='tableFormButton'> <img src='/../../media/images/silk/icons/pencil.png' alt='Edit' ></button>";

var delButtonHtml = "<button type='submit' name='btnDel' style='cursor:pointer;' title='Delete' action='delButton' class='tableFormButton'> <img src='/../../media/images/silk/icons/delete.png' alt='Delete'  '></button>";


//  This will set up the widgets for the various forms at runtime with the livequery Jquery plugin.
//  All forms are setup as the DOM is loaded. 

//		$('body').css('width', window.innerWidth).css('height', window.innerHeight);

//  Patient Registration Form Widgets
/*
		$( '#id_first_name' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_last_name' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_age' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });

		$( '#id_address' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_city' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_district' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_state' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
		$( '#id_phone' ).livequery( function(){ $(this).css({ 'border': 'solid 1pt red' }); });
*/
// 	Admission Form Widgets
 		$( '#id_date_of_admission, #id_visit_date' ).livequery( 
 											function(){ 
 														$(this).
 														   datetimepicker( defaultTimePickerOptions ); 
 											}
     );

/*
		$( ' #id_admission_detail,  #id_patient_detail' ).livequery( function(){ 
									var parent_tr 		= $(this).parents('tr');
									console.log(parent_tr.attr('class'));
									console.log($(this).parents('td').attr('id'))
									if(parent_tr.hasClass('no_hide')){
														$(this).parents('td').hide();
									}
									else{
														$(this).parents('tr').hide();
									}
							}
	);
*/

$( '#id_complaints, #id_duration' ).livequery( 
						function(){ 
						     $("#id_complaints, #id_duration").each( function(r,i){
						          $(this).attr("autocomplete_id", $(this).attr("id")+"_"+ r);
						     });
						});

$("input[new_id^=id_complaints_]").livequery(function(){
             $(this).autocomplete( { source	: presenting_complaints } ); 
             });

$('input[new_id^=id_duration_]').livequery ( function(){ 
             $( this ).autocomplete( { source	: duration } );  
             });



		//$( '#id_patient_detail' ).livequery( function(){ $(this).parents('tr').hide(); });
		

		$( '#id_date_of_admission' ).livequery( function(){ 
																$(this).
																	css({ 'border': 'solid 1pt red' }) 
															});
 		$( '#id_admitting_surgeon' ).livequery( function(){ 
 																$(this).
 																	parent().
 																	parent().
 																	css( { 'border': 'solid 1pt red' } ); 
 																});


// 		OPD Visit Form Widgets
		$( '#id_visit_detail' ).livequery( function(){ 
																					$(this).parents('tr').hide(); 
																			});


// HPI Form Widgets
		$( '#id_hpi' ).livequery( function(){ 
																		$(this).cleditor(defaultCLEditorOptions); 
														});

// 	Past History Form Widgets
		$( '#id_past_history' ).livequery( function(){ 
																					$(this).cleditor(defaultCLEditorOptions); 
																		});

//  Imaging Form Widgets
		$( '#id_finding' ).livequery( function(){ 
																					$(this).cleditor(defaultCLEditorOptions); 
																});

// 		Physical Examination Form Widgets
		$( '#id_phyexam_detail' ).livequery( function(){ $(this).parents('tr').hide(); });
		$( '#id_reg_exam' ).livequery( function(){ $(this).parents('tr').hide(); });

//		$('#admission_diagnosis_add_form table').livequery( function(){ $(this).hide(); });

// Procedure Form Widgets
		$( '#id_procedure_detail' ).livequery( function(){ $(this).parents('tr').hide(); });
		var procedure_site_list = [ 'Head', 'Neck',	'Cervical Spine',  'Shoulder', 'Chest', 'Thorax'				,
																'Abdomen', 'Arm', 'Elbow', 'Forearm', 'Wrist', 'Hand' , 'Dorsal Spine'	,
																'Lumbar Spine', 'Sacrum', 'Coccyx','Pelvis', 'Perineum', 'Hip', 'Thigh'	,
																'Knee', 'Leg', 'Ankle', 'Foot'
															]
		$('#id_site').livequery( function(){$(this).autocomplete( {source: procedure_site_list} ); });

			$('a').click( function(e){
													if( $(this).hasClass('isProcessing') ){
														return false;
													}
			});

/*
			$('button').livequery( function(){
																$(this).
																		css('border','solid 1pt #aaa').
																		css('background','-moz-linear-gradient(bottom, silver, white)').
																		css('border-radius','10px').
																		css('box-shadow','2px 2px 5px #ddd').
																		css('padding-left','10px').
																		css('height','40px').css('margin','20').
																		css('min-width','150px').
																		css('font-size','16px').
																		css('font-weight','bold').
																		css('vertical-align','middle');

																$(this).hover( function() { $(this).css('border','solid 1pt lightsteelblue')},
																							 function() { $(this).css('border', 'solid 1pt #aaa')}
																);
																$(this).mousedown(
																					function(){ $(this).css('border','solid 1pt #ddd').
																															css('box-shadow','inset 0 0 10px #aaa');
																						}
																);
																$(this).mouseup(
																					function(){ 
																							$(this).css('border','solid 1pt #aaa').
																									css('box-shadow','2px 2px 5px #ddd');
																					}
																);
		});
*/

	$('button.tableFormButton').live('click', onTableFormButtonClick );

	function onTableFormButtonClick(e){
	  e.preventDefault();
		var $form      = $(this).parents('form');
		var btn_action = $(this).attr('action'); 
		$form.find('input.'+ btn_action +'').trigger('click');
	}

	$(".submitButton").live('click',
			function(evt){
					var $evt = jQuery(evt.target);
					$(this).parents(".tableForm").submit(
						  [$evt],
							function(e){ 
										e.preventDefault(); 
										var $target             = jQuery(e.target); 
										var action              = $target.attr('action'); 
										var method              = $target.attr('method');
										var form_data           = $target.serialize();
										var redirect_url        = $target.attr('redirectUrl');
										var update_rsidebar     = $evt.attr('updateRsidebar');
										var reload_rsidebar_url = $evt.attr('reloadRsidebarUrl');
										var test_lists          = $evt.attr('testLists');
										var rsidebar_div_id     = $evt.attr('rsidebarDivId');
										var parent_div          = $target.
											                          closest('.parentTable').
											                          closest('.parentDiv');
									if($evt.attr("action") =='editButton' || $evt.attr('action')=="addButton"){
										$.ajax({
													url				: action    ,
													type			: method    ,
													data			: form_data ,
													dataType	: 'json'    ,
													success		: function(json){
																				if ( json.success == true) {
																					renderAjaxMessage(json);
																					$.get(
																						redirect_url,
																						{},
																						function(html){ 
																								parent_div.
																									html(html); 
																						},
																						'html'
																					);
																					}
																				else if ( json.success == false){
																					renderAjaxMessage(json);
																				}
																			},
													error			: function(json){
																				renderAjaxMessage(json);
																			}
												}
											);
										}
										else if($evt.attr("action")=='delButton'){
											var confirm_dialog = confirm("Are you sure you want to delete ?");
											if (confirm_dialog == true){
													console.log(test_lists.split(',')[1]);
													$.get(
														$evt.attr('url'),
														{},
														function(json){
															if ( json.success == true) {
																renderAjaxMessage(json);
																$.get(
																	redirect_url,
																	{'redirect': false},
																	function(html){ 
																			parent_div.
																				html(html); 
																	},
																	'html'
																);
																if(update_rsidebar == 'true'){
																	if (reload_rsidebar_url && rsidebar_div_id){
																		$.get(
																			reload_rsidebar_url,
																			{},
																			function(html){ 
																					$(rsidebar_div_id).
																						html(html).
																						find('form').
																						addClass('panelForm'); 
																			},
																			'html'
																		);
																	}
																	else{
																	location.reload(true);
																	}
																}
															}
															else if ( json.success == false){
																	renderAjaxMessage(json)
															}
														},
														'json'
													);
												}
											else{
												return false;
											}
										}
										else if($evt.attr("action")=='viewButton'){
											$.get(
												redirect_url,
												{},
												function(html){ 
														parent_div.
															html(html); 
												},
												'html'
											);
										}
						}
					);
			}
	);

	$(".intro form").
	     livequery( 
	      function(){
	          $(this).addClass("tableForm");
	      }
	    );

	$(".lsidebar form, .rsidebar form").
	     livequery(
	         function(){
	               $(this).addClass("panelForm");
	         }
	     );

			$('form').livequery( function(){
//														var cloned_preloader = $('#preloader').clone();
//														$(this).parents('div').append('<div class="preloader_div"> </div>');
//														$('.preloader_div').each( function(){ $(this).html(cloned_preloader).hide(); });
															var this_html = $(this).closest('.parentDiv').html();
															var cloned_preloader = $("#preloader").clone();
									$(this).ajaxStart(
															function(){
																			$('a').each( function(){ $(this).addClass('isProcessing'); });
//																			$(this).
//																				closest('.parentDiv').
//																				html(cloned_preloader).
//																				fadeIn('slow');
																			$(this).
																					find('input[type=submit], input[type=button], \
																								button, input[type=image]\
																								input[type=text], input[type=radio],\
																								input[type=checkbox], input[type=radio],\
																								textarea, select').
																					attr('disabled', 'disabled');
															}
													).ajaxStop(
															function(){ 
																			$('a').each( function(){ $(this).removeClass('isProcessing'); });
//																			$(this).closest('.parentDiv').
//																								html(cloned_preloader).
//																								fadeOut('slow').
//																								html(this_html).
//																								fadeIn('slow');
																			$(this).
																				find('input[type=submit], input[type=button], \
																								button, input[type=image]\
																								input[type=text], input[type=radio],\
																								input[type=checkbox], input[type=radio],\
																								textarea, select').
																				removeAttr('disabled');
															}
													).ajaxError(
																function(e, jqxhr, settings, exception){
																	$('a').each( function(){ $(this).removeClass('isProcessing'); });
																	var error_html = "<p class='ui-widget ui-icon-alert '>Server Error requesting page " + settings.url + " &nbsp; Error:: " + jqxhr.responseText + "</p>";
																			$('.content').after('<div class="ajaxErrorDiv"');
																			$('.ajaxErrorDiv').html(error_html);
																			$('.ajaxErrorDiv').fadeIn('1000').fadeOut('3000');
//																			$(this).closest('.parentDiv').
//																								html(cloned_preloader).
//																								fadeOut('slow').
//																								html(this_html).
//																								fadeIn('slow');
																}
													);
/*
										$(this).parents('fieldset').css('border','solid 2t #aaa').
											css('width','55%').
											css('border','solid 2pt lightsteelblue').
											css('border-radius', '10px');
										$(this).
											css('background !important','-moz-linear-gradient(bottom, whitesmoke, white)').
											css('background !important','-webkit-linear-gradient(bottom, whitesmoke, white)').
											css('border','solid 2pt #ddd').
											css('border-radius','15px').
											css('box-shadow','2px 2px 5px #ddd').
											css('font-family','Cantarell').
//																	css('text-shadow','2px 2px 2px #ddd').
											css('width','auto');
*/

										if( $(this).hasClass('panelForm')){
                      $(this).
                        css("margin-bottom",'10px').
                        css("padding-left",'10px');
										  $(this).
										    find('table tr').
										    css("margin-bottom",'15px').
										    css('padding-bottom','15px');
											$(this).find('label').
												css('font-size','14px').
												css('padding','0px').
												css('color','Navy').
												css('margin','0');
											$(this).find('span.helptext').
												css('font-size','12px').
												css('font-style','italics').
												css('padding','0px').
												css('color','#2779AA').
												css('margin','0');
											$(this).
													find( 'input[type= submit], button, input[type=button]' ).
													addClass( 'ui-content ui-widget ui-button action_button' ).
													css('border','solid 1px #aaa').
													css('background','-moz-linear-gradient(bottom, silver, white)').
													css('background','-webkit-linear-gradient(bottom, silver, white)').
													css('border-radius','5px').
													css('box-shadow','1px 1px 2px #ddd').
													css('padding','0px').
													css('height','30px').css('margin','0px').
													css('min-width','120px').
													css('font-size','14px').
													css('font-weight','normal').
													css('vertical-align','middle');
											$(this).
													find( 'input[type= text] ,input[type=password]').
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('padding','0px').
													css('height','30px').
													css('width','150px').
													css('font-size','14px');
											$(this).
													find( 'input[type= radio], input[type=checkbox]' ).
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' )
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, silver, white)').
//													css('background','-webkit-linear-gradient(bottom, silver, white)').
//													css('box-shadow','2px 2px 5px #ddd')
													;
											$(this).
													find( 'select' ).
													addClass( 'ui-widget-content ui-widget ' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('padding','0px').
													css('height','30px').
													css('width','150px').
													css('text-align','center').
													css('font-size','	14px');
											$(this).
													find( 'textarea' ).
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('padding','0px').
													css('height','150px').
													css('max-width','150px').
													css('text-align','justify').
													css('font-size','14px');
										}
										else if( $(this).hasClass('tableForm')){
                      $(this).
                        css("margin-bottom",'10px').
                        css("padding-left",'10px');
										  $(this).
										    find('table tr').
										    css("margin-bottom",'15px').
										    css('padding-bottom','15px');
										  $(this).
										    find('table tbody tr td, table thead tr th').
										    css("margin",'5px').
										    css('padding','5px');
											$(this).find('label').
												css('font-size','16px').
												css('padding','0px').
												css('color','Navy').
												css('margin','0');
											$(this).find('span.helptext').
												css('font-size','12px').
												css('font-style','italics').
												css('padding','0px').
												css('color','#2779AA').
												css('margin','0');
											$(this).
													find( 'input[type= submit], button, input[type=button]' ).
													addClass( 'ui-widget-content ui-widget ui-button action_button' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, silver, white)').
//													css('background','-webkit-linear-gradient(bottom, silver, white)').
//													css('border-radius','5px').
//													css('box-shadow','1px 1px 2px #ddd').
													css('padding','0px').
													css('height','35px').
													css('margin','0px').
													css('min-width','100px').
													css('font-size','16px').
													css('font-weight','normal').
													css('vertical-align','middle').
													css('text-align','right');

											if( $(this).find( '.viewButton' ).length>0)
											{
													$(this).
														find( 'input[type= submit]' ).hide();
	  											$(this).
	  											  find('tbody tr td:last').
	  											  append(viewButtonHtml);
											}

											if( $(this).find( '.addButton' ).length>0)
											{
													$(this).
														find( 'input[type= submit]' ).hide();
	  											$(this).
	  											  find('tbody tr td:last').
	  											  append(addButtonHtml);
											}

											if( $(this).find( '.saveButton' ).length>0)
											{
													$(this).
														find( 'input[type= submit]' ).hide();
	  											$(this).
	  											  find('tbody tr td:last').
	  											  append(saveButtonHtml);
											}

											if( $(this).find( '.editButton' ).length>0)
											{
													 $(this).
														 find( 'input[type= submit]' ).hide();
													 $(this).
													   find('tbody tr td:last').
													   append(editButtonHtml);
											}

											if($(this).find( '.delButton' ).length>0)
											{
													$(this).
														find( 'input[type= submit]' ).hide();
	  											$(this).
	  											  find('tbody tr td:last').
	  											  append(delButtonHtml);
											}

											$(this).
													find( 'input[type= text] ,input[type=password]').
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('margin','10px').
													css('padding','0px').
													css('padding-left','10px').
													css('height','35px').
													css('width','200px').
													css('max-width','90%').
													css('font-size','16px');
											$(this).
													find( 'input[type= radio], input[type=checkbox]' ).
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' ).
//													css('border','solid 1px #aaa').
//													css('box-shadow','2px 2px 5px #ddd').
//													css('background','-moz-linear-gradient(bottom, silver, white)').
//													css('background','-webkit-linear-gradient(bottom, silver, white)').
													css('margin','10px');
											$(this).
													find( 'select' ).
													addClass( 'ui-widget-content ui-widget ' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('padding','0px').
													css('margin','10px').
													css('height','35px').
													css('width','200px').
													css('max-width','80%').
													css('text-align','center').
													css('font-size','	16px');
											$(this).
													find( 'textarea' ).
													addClass( 'ui-widget-content ui-widget ui-helper-clearfix' ).
//													css('border','solid 1px #aaa').
//													css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
//													css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
//													css('border-radius','5px').
//													css('box-shadow','inset 0 0 10px #ddd').
													css('padding','0px').
													css('padding-left','10px').
													css('margin','10px').
													css('height','45px').
													css('width','200px').
													css('max-width','90%').
													css('text-align','center').
													css('font-size','16px');
											$(this).
												find("textarea").
												click(function(){ $(this).animate({'height':'200px'},350); }).
												focus(function(){ $(this).animate({'height':'200px'},350); }).
												blur(function(){ $(this).animate({'height':"35px"},350); });
										}
								else{
										$(this).find('label').
											css('font-size','20px').
											css('padding-right','5px').css('color','RoyalBlue');
										$(this).
												find( 'input[type= submit], button, input[type=button]' ).
												addClass( 'ui-content ui-widget ui-button action_button' ).
												css('border','solid 1pt #aaa').
												css('background','-moz-linear-gradient(bottom, silver, white)').
												css('background','-webkit-linear-gradient(bottom, silver, white)').
												css('border-radius','10px').
												css('box-shadow','2px 2px 5px #ddd').
												css('padding-left','10px').
												css('height','40px').css('margin','20px').
												css('min-width','150px').
												css('font-size','16px').
												css('font-weight','bold').
												css('vertical-align','middle');
										$(this).
												find( 'input[type= text] ,input[type=password]').
												addClass( 'ui-widget-content ui-widget ui-button action_button' ).
												css('border','solid 1pt #ddd').
												css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
												css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
												css('border-radius','5px').
												css('box-shadow','inset 0 0 10px #ddd').
												css('padding-left','10px').
												css('height','45px').
												css('width','250px').
												css('font-size','16px');
										$(this).
												find( 'input[type= radio], input[type=checkbox]' ).
												addClass( 'ui-widget-content ui-widget ui-button action_button' ).
												css('border','solid 1pt #ddd').
												css('background','-moz-linear-gradient(bottom, silver, white)').
												css('background','-webkit-linear-gradient(bottom, silver, white)').
												css('box-shadow','2px 2px 5px #ddd');
										$(this).
												find( 'select' ).
												addClass( 'ui-widget-content ui-widget ui-button action_button' ).
												css('border','solid 1pt #ddd').
												css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
												css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
												css('border-radius','5px').
												css('box-shadow','inset 0 0 10px #ddd').
												css('padding-left','10px').
												css('height','45px').
												css('width','250px').
												css('text-align','center').
												css('font-size','	16px');
										$(this).
												find( 'textarea' ).
												addClass( 'ui-widget-content ui-widget ui-button action_button' ).
												css('border','solid 1pt #ddd').
												css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
												css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
												css('border-radius','5px').
												css('box-shadow','inset 0 0 10px #ddd').
												css('padding-left','10px').
												css('height','100px').
												css('max-width','90%').
												css('text-align','justify').
												css('font-size','16px');
										  
										$(this).find('input[type=text]	,input[type=password]	\
																	input[type=radio]	, input[type=checkbox], \
																	textarea, select').
														hover( 
														  function(){ 
														    if( $(this).not('disabled') ){
																  $(this).css('border','solid 1pt lightsteelblue');
//																$(this).parent().parent().
//																css('background !important','-moz-linear-gradient(bottom, papayawhip, white)');
																}
															},
															function() { 
																	$(this).css('border', 'solid 1pt #ddd');
//																$(this).parent().parent().css('background','auto');
														  }
														);
										$(this).find('input[type=button]	, input[type=submit],button').
														hover( function() { $(this).css('border','solid 1pt lightsteelblue')},
																	 function() { $(this).css('border', 'solid 1pt #aaa')}
														);
										$(this).find('input[type=text]	,,input[type=password], select	,\
																	input[type=radio], input[type=checkbox], textarea').
														focus(
																function(){ 
																  $(this).css('border','solid 1pt lightsteelblue').
																					css('box-shadow','inset 0 0 10px #aaa').
																					css('background','-moz-linear-gradient(bottom, papayawhip, white)').
																					css('background','-webkit-linear-gradient(bottom, papayawhip, white)').
																					css('font-family','comic sans MS');
//																				$(this).parent().parent().
//																					css('background','-moz-linear-gradient(bottom, papayawhip, white)');
																}
														);
										$(this).find('input[type=text]	,input[type=password],select	,\
																	input[type=radio], input[type=checkbox], textarea').
														blur(
																function(){ 
																  $(this).
																     css('border','solid 1pt #ddd').
																		 css('box-shadow','inset 0 0 10px #ddd').
																		 css('background','-moz-linear-gradient(bottom, whitesmoke, white)').
																		 css('background','-webkit-linear-gradient(bottom, whitesmoke, white)').
																		 css('font-family !important','Cantarell');
//																$(this).parent().parent().
//																	css('background','auto');
																}
														);
										$(this).find('input[type=submit], input[type=image], button, input[type=button]').
										        mousedown(
															function(){ 
															     $(this).
															      css('border','solid 1pt #ddd').
																		css('box-shadow','inset 0 0 10px #aaa');
															}
														);
										$(this).find('input[type=submit], input[type=image], button, input[type=button]').
										        mouseup(
															function(){ 
																	$('a').each( function(){ $(this).addClass('isProcessing'); });
																  $(this).css('border','solid 1pt #aaa').
																					css('box-shadow','2px 2px 5px #ddd');
															}
														);
										}
	});

		$('table.dataTable ').
						livequery( 
									function(){
											$(this).find('span.list_table_action_menu, input[name=list_table_choice_radio]').hide();
											var all_rows 	= $(this).find('tbody tr');
//											var header 		= $(this).find('thead tr');
											all_rows.each( function(){ 
																			$(this).css('background','-moz-linear-gradient(top, white, whitesmoke)').
																							css('background','-webkit-linear-gradient(top, white, whitesmoke)').
																							css('border', 'solid 1px #aaa');
																			$(this).find('td').css('padding','1px');
//																			$(this).find('td:first').hide();
																		}
											);
//											header.each( function(){$(this).find('th:first').hide();});
						}
		);

		$('.dataTables_wrapper').livequery( function(){ 
																						$(this).
																								css('max-height', '100%').
																								css('overflow','auto'); 
																				});

		$('table.dataTable tr.selected_tr').livequery(
				function(){ 
					  if( $(this).parents('table').attr('id') == 'patient_list_table'){
				      $("#patient_droppable_div_accordion").
				        accordion('option', 'disabled',false);
					  }
						$(this).
							css('border','solid 1px #ddd').
							css('box-shadow','inset 0 0 10px papayawhip').
							css('background','-moz-linear-gradient(bottom, PaleGoldenRod, whitesmoke)').
							css('background','-webkit-linear-gradient(bottom, PaleGoldenRod, whitesmoke)').
							css('font-size !important', '14px').css('color !important', 'sienna').
							css('font-weight','bold').animate({'opacity': 1}, 1500);
						$(this).find('img').css('width','20px').css('height','20px');
//						$(this).find('span.list_table_action_menu').show('fast');
				}
		);

		$('table.dataTable tbody tr').hover(
				function(){ 
						if( $(this).hasClass('selected_tr') == false){
								$(this).css('cursor','pointer').
												css('background','-moz-linear-gradient(bottom, papayawhip, white)').
												css('background','-webkit-linear-gradient(bottom, papayawhip, white)').
												css('border', 'solid 1px #aaa').
												css('box-shadow','inset 0 0 10px #aaa').animate({'opacity': 1}, 1500);
								$(this).find('td').css('border', 'solid 1px #aaa');
//								$(this).find('span.list_table_action_menu').show('fast');
								$(this).find('img').css('width','18px').css('height','18px');
						}
				}, 
				function(){ 
						if( $(this).hasClass('selected_tr') == false){
								$(this).css('cursor','default').
												css('background','-moz-linear-gradient(top, white, whitesmoke)').
												css('background','-webkit-linear-gradient(top, white, whitesmoke)').
												css('border', 'solid 1px #aaa').
												css('box-shadow','none').animate({'opacity': 1}, 1500);
								$(this).find('td').css('border', 'solid 1px #ddd');
								$(this).find('img').css('width','16px').css('height','16px');
//								$(this).find('span.list_table_action_menu').hide('fast');
						}
				}
		);

		$('table.dataTable tbody tr td').click( 
				function(evt){ 
					if( this.tagName == 'TD' && evt.target.nodeName != 'INPUT'){
							if( $(this).parents('tr').hasClass('selected_tr') == false){
								$(this).parents('table').find('tr.selected_tr').each(
									function(){ 
									  if( $(this).parents('table').attr('id') == 'patient_list_table'){
  							      $("#patient_droppable_div_accordion").accordion('option', 'disabled',false);
									  }
										$(this).removeClass('selected_tr');
										$(this).find('img').css('width','16px').css('height','16px');
										$(this).css('background','-moz-linear-gradient(top, white, whitesmoke)').
														css('background','-webkit-linear-gradient(top, white, whitesmoke)').
														css('border', 'solid 1px #aaa').
														css('box-shadow','none').
														css('cursor','default').
														css('font-size ', '14px').css('color', 'black').
														css('font-weight','normal').animate({'opacity': 1}, 1500);
										$(this).find('td').css('border', 'solid 1px #ddd');
//										$(this).find('span.list_table_action_menu').hide('fast');
									 }
								);
							}
							if( $(this).parents('tr').hasClass('selected_tr') == false){
								$(this).parents('tr').addClass('selected_tr');
								$(this).find('img').css('width','20px').css('height','20px');
//								$(this).find('span.list_table_action_menu').show('fast');
							}
						  if( $(this).parents('table').attr('id') == 'patient_list_table'){
					      $("#patient_droppable_div_accordion").accordion('option', 'disabled',false);
						  }
							console.log('Setting the background and triggering the event....');
							$(this).parents('tr').find('input[type=radio][name=list_table_choice_radio]').trigger('click');
					}
				}
		);


//	$.ajaxSetup({timeout: 10000});

/*
	$('table.dataTable').livequery( function(){
					$(this).css('border', 'solid 2pt #aaa').
									css('border-radius', '10px').
									css('background', '-moz-linear-gradient(bottom, whitesmoke, white)').
									css('box-shadow','5px 5px 5px #aaa').
									css('max-width !important', '60%').
									css('height', 'auto').
									css('font-family !important', 'Cantarell').
									css('font-size !important','18px');
					$(this).find('tr td').
									css('font-family !important', 'Cantarell').
									css('font-size !important','18px');
					$(this).find('tr td:first, th:first, td:last, th:last').css('max-width !important','20px');
	});
*/

$('.tableForm input[class=submitButton][action=delButton]').live('click',function(){
		var elem = $(this).closest('.parentTable');
		$.confirm({
			'title'		: 'Delete Confirmation',
			'message'	: 'You are about to delete this item. <br />It cannot be restored at a later time! Continue?',
			'buttons'	: {
				'Yes'	: {
					'class'	: 'ui-button ui-state-active',
					'action': function(){
						elem.slideUp();
					}
				},
				'No'	: {
					'class'	: 'ui-button ui-state-disabled',
					'action': function(){}	// Nothing to do in this case. You can as well omit the action property.
				}
			}
		});
});

});

//////////////////////////// Handle Ajax Success / Error Messages ///////////////////

	function renderAjaxMessage(json){
						$('#footer_json_message_div').
								find( '.json_message_div' ).
								 html('').html( json.error_message ).
								 css( stdFeildsBlankMessageCss ).
								 fadeIn( 700 ).fadeOut( 5000 );
	}
	
/////////////////////////////////////////////////////////////////////////////////////

